<div class="formattedText" data-external-links="">
                                <p>Agora vamos colocar o versionamento, que acabamos de ativar, em prática. Estamos trabalhando com o <em>bucket</em> "rmerces-labs5", que está com o versionamento ativado.</p>
<p>Vamos usar os comandos <code>echo 1 &gt;</code> e <code>cat</code> para criar um arquivo, "teste.txt", com o número 1 como conteúdo. Na sequência vamos subir esse objeto para nosso <em>bucket</em>:</p>
<pre class="prettyprint"><code class="hljs language-bash"><span class="hljs-built_in">echo</span> 1 &gt; teste.txt
<span class="hljs-built_in">cat</span> texte.txt
aws s3 <span class="hljs-built_in">cp</span> teste.txt s3://rmerces-labs5</code><button type="button" class="clipit">Copiar código</button></pre><p>Se, enquanto trabalhamos no projeto, precisarmos alterar o conteúdo do arquivo, basta inserirmos o comando <code>echo</code>, mas substituindo o 1 pelo 2, por exemplo, antes de subir o arquivo:</p>
<pre class="prettyprint"><code class="hljs language-bash"><span class="hljs-built_in">echo</span> 2 &gt; teste.txt
aws s3 <span class="hljs-built_in">cp</span> teste.txt s3://rmerces-labs5</code><button type="button" class="clipit">Copiar código</button></pre><p>Depois disso, a nova versão do arquivo será enviada ao repositório selecionado. Agora executaremos o comando <code>aws s3 ls s3://rmerces-labs5</code>. Ao fazer isso, perceberemos que há apenas um arquivo no <em>bucket</em>, apesar de termos feito o <em>upload</em> de duas versões. Trata-se da versão mais recente.</p>
<p>Se visualizarmos o repositório via <em>console</em>, poderemos selecionar a opção <em>"Show versions"</em> e, assim, veremos as duas versões do arquivo "teste.txt". Apesar de compartilharem do mesmo nome, cada uma delas tem sua própria <em>ID</em>. Quando desligamos o botão de <em>"Show versions"</em>, visualizamos apenas a versão mais recente.</p>
<p>Agora vamos aprender a listar as versões via <em>CLI</em>. Para fazê-lo, vamos executar o comando <code>aws s3api list-object-versions --bucket rmerces-labs5</code>. Já poderemos, com isso, visualizar as duas versões, embora que de maneira não muito clara. Deixaremos a visualização mais clara adicionando <code>grep -A1 teste.txt</code>:</p>
<pre class="prettyprint"><code class="hljs language-csharp">aws s3api list-<span class="hljs-built_in">object</span>-versions --bucket rmerces-labs5 | grep - A1 teste.txt</code><button type="button" class="clipit">Copiar código</button></pre><p>É possível recuperar versões mais antigas, como a primeira versão do arquivo "teste.txt". Primeiro, vamos apagar a versão mais atual com <code>rm -rf teste.txt</code>, para que não nos confundamos, e usar o comando <code>aws s3api get-object --bucket rmerces-labs5 --key teste.txt --version-id</code>, adicionando, também, a <em>ID</em> da versão desejada e <code>teste.txt</code>, ao final, para fazer a recuperação via <em>CLI</em>.</p>
<p>Agora vamos conferir se deu certo, ainda pela linha de comando:</p>
<pre class="prettyprint"><code class="hljs language-bash"><span class="hljs-built_in">ls</span>
<span class="hljs-built_in">cat</span> teste.txt</code><button type="button" class="clipit">Copiar código</button></pre><p>Depois da execução, veremos que o conteúdo do arquivo voltou a ser 1. Logo, recuperamos sua primeira versão com sucesso.</p>
<p>Também é possível recuperar versões antigas pelo <em>console</em>. O processo é, inclusive, mais simples. Basta acessarmos "rmerces-labs5 &gt; Show versions &gt; teste.txt &gt; Download". É importante clicarmos na versão de "testes.txt" que desejamos restaurar.</p>
<p>No próximo vídeo, vamos aprender sobre <em>life cycle</em>.</p>
                        </div>